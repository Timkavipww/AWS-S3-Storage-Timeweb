# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é API

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ `.env`
–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ –Ω–µ–≥–æ —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```plaintext
# –ü–ï–†–ï–ò–ú–ï–ù–û–í–ê–¢–¨ –í .ENV
AWS_ACCESS_KEY=
AWS_SECRET_ACCESS_KEY=
AWS_SERVICE_URL=https://s3.timeweb.cloud
AWS_BUCKET_NAME=
ASPNETCORE_URLS=http://+:80
```

–≠—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç –¥–æ—Å—Ç—É–ø –∫ AWS S3 (–∏–ª–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–º—É —Å–µ—Ä–≤–∏—Å—É) –∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –±–∞–∑–æ–≤—ã–π URL API.
https://timeweb.cloud/my/storage

---

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à –ø—Ä–æ–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –ï—Å–ª–∏ –æ–Ω–∏ –µ—â—ë –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É –¥–ª—è –∏—Ö —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

```bash
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ NuGet
dotnet add package AWSSDK.Extensions.NETCore.Setup --version 4.0.0-preview

dotnet add package AWSSDK.S3 --version 4.0.0-preview

dotnet add package DotNetEnv --version 3.1.1

dotnet add package Microsoft.AspNetCore.OpenApi --version 9.0.2

dotnet add package Scalar.AspNetCore --version 2.0.21
```

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –≤–∞—à–µ–º —Ñ–∞–π–ª–µ `.csproj` –≤–∫–ª—é—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```xml
<Project Sdk="Microsoft.NET.Sdk.Web">
  <PropertyGroup>
    <TargetFramework>net9.0</TargetFramework>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
    <RootNamespace>_dotnetaws</RootNamespace>
  </PropertyGroup>
  <ItemGroup>
    <PackageReference Include="AWSSDK.Extensions.NETCore.Setup" Version="4.0.0-preview" />
    <PackageReference Include="AWSSDK.S3" Version="4.0.0-preview" />
    <PackageReference Include="DotNetEnv" Version="3.1.1" />
    <PackageReference Include="Microsoft.AspNetCore.OpenApi" Version="9.0.2" />
    <PackageReference Include="Scalar.AspNetCore" Version="2.0.21" />
  </ItemGroup>
</Project>
```

---

## –ö–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ API

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º S3 (AWS)

#### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ S3-–±–∞–∫–µ—Ç–∞
```
POST /api/aws
```
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `bucketname` (—Å—Ç—Ä–æ–∫–∞, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): –ò–º—è —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–≥–æ –±–∞–∫–µ—Ç–∞.

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –±–∞–∫–µ—Ç–∞
```
GET /api/aws/metadata
```
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `bucketname` (—Å—Ç—Ä–æ–∫–∞, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): –ò–º—è –±–∞–∫–µ—Ç–∞.

#### –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –±–∞–∫–µ—Ç–æ–≤
```
GET /api/aws
```
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –±–∞–∫–µ—Ç–æ–≤.

#### –°–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –±–∞–∫–µ—Ç–µ
```
GET /api/aws/objects
```
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `bucketname` (—Å—Ç—Ä–æ–∫–∞, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): –ò–º—è –±–∞–∫–µ—Ç–∞, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤.

#### –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –≤–Ω—É—Ç—Ä–∏ –±–∞–∫–µ—Ç–∞
```
POST /api/aws/copy
```
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `bucketname` (—Å—Ç—Ä–æ–∫–∞, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): –ë–∞–∫–µ—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –æ–±—ä–µ–∫—Ç.
- `FromobjectKey` (—Å—Ç—Ä–æ–∫–∞, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): –ö–ª—é—á –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.
- `toObjectKey` (—Å—Ç—Ä–æ–∫–∞, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): –ö–ª—é—á –Ω–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ (–∫–æ–ø–∏–∏).

---

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞–º–∏ (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–¥–µ–∂–¥—ã)

#### –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```
POST /api/clothings/{id}/image
```
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏:**
- `id` (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞ –æ–¥–µ–∂–¥—ã.

**–î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã:**
- `Data` (—Ñ–∞–π–ª, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): –§–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏.

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```
GET /api/clothings/{id}/image
```
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏:**
- `id` (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞ –æ–¥–µ–∂–¥—ã.

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω –Ω–∞–π–¥–µ–Ω.

#### –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```
DELETE /api/clothings/{id}/image
```
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏:**
- `id` (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞ –æ–¥–µ–∂–¥—ã.

–£–¥–∞–ª—è–µ—Ç —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.

---

## –ó–∞–ø—É—Å–∫ API

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ .NET
–î–ª—è –∑–∞–ø—É—Å–∫–∞ API –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:
```bash
dotnet run
```

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker
–ï—Å–ª–∏ API —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ Docker, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `.env` –∑–∞–≥—Ä—É–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
docker build -t my-dotnet-api .
docker run --env-file .env -p 80:80 my-dotnet-api
```

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose
–î–ª—è —É–ø—Ä–æ—â—ë–Ω–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ API –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `docker-compose`:

#### 1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `docker-compose.yml`:
```yaml
services:
  backend:
    container_name: aws
    build:
      context: .
      dockerfile: Dockerfile
    env_file:
      - .env
    ports:
      - 80:80
    networks:
      - app-network

networks:
  app-network:
    driver: bridge
```

#### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:
```bash
docker-compose up -d
```
–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –∏ –∑–∞–ø—É—Å—Ç–∏—Ç API –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.

–¢–µ–ø–µ—Ä—å API –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –∞–¥—Ä–µ—Å–∞–º:
```
http://localhost/api/aws
http://localhost/api/clothings
```

---

## –ü—Ä–∏–º–µ—Ä—ã URL –¥–ª—è Postman

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–∏ URL –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API –≤ **Postman** –∏–ª–∏ –¥—Ä—É–≥–æ–º HTTP-–∫–ª–∏–µ–Ω—Ç–µ:

| –ö–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞         | –ú–µ—Ç–æ–¥  | –ü—Ä–∏–º–µ—Ä URL |
|------------------------|--------|--------------------------------|
| –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è   | POST   | `http://localhost/api/clothings/2/image` |
| –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è  | GET    | `http://localhost/api/clothings/2/image` |
| –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è   | DELETE | `http://localhost/api/clothings/2/image` |
| –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∫–µ—Ç–∞        | POST   | `http://localhost/api/aws?bucketname=mybucket` |
| –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –±–∞–∫–µ—Ç–∞      | GET    | `http://localhost/api/aws/metadata?bucketname=mybucket` |
| –°–ø–∏—Å–æ–∫ –±–∞–∫–µ—Ç–æ–≤         | GET    | `http://localhost/api/aws` |
| –°–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤        | GET    | `http://localhost/api/aws/objects?bucketname=mybucket` |
| –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞    | POST   | `http://localhost/api/aws/copy?bucketname=mybucket&FromobjectKey=old.jpg&toObjectKey=new.jpg` |

---

### üîπ –ü—Ä–∏–º–µ—á–∞–Ω–∏—è:
- –≠—Ç–æ—Ç API –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å **AWS S3** –∏–ª–∏ –¥—Ä—É–≥–∏–º —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º.
- –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ AWS-—É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ `.env`.
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è OpenAPI/Scalar –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost/scalar/v1`, –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞.

–ü—Ä–∏—è—Ç–Ω–æ–≥–æ –∫–æ–¥–∏–Ω–≥–∞! üöÄco